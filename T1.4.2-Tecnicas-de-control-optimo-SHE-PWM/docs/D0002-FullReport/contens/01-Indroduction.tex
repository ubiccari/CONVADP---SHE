\section{Introduction}

In this document, we propose  a optimal control  perspective of selective harmonic elimination problem (SHE) with symmetry of quarter wave. 
%
In mathematical point of view, SHE problem can be seen as search of a square wave function  $f(\omega t ) \ | \ \omega t \in (0,2\pi)$ which have fixed a few Fourier coefficients. 
\newline

%
In this way, the $f(\omega t)$ can be written in Fourier series as follows:

\begin{gather}
    f(\omega t ) = \sum_{n=1}^\infty [a_n \cos(n\omega t) + b_n \sin(n \omega t)] 
\end{gather}

Where $a_n$ and $b_n$ coefficients are:
\begin{gather}
    a_n = \frac{1}{2\pi} \int_0^{2\pi} f(\omega t ) \cos(n\omega t)d(\omega t) \label{an}\\
    b_n = \frac{1}{2\pi} \int_0^{2\pi} f(\omega t ) \sin(n\omega t)d(\omega t) \label{bn}    
\end{gather}

On the other hand, the symmetry of quarter wave implies:

\begin{gather}
    f(\omega t + \pi)     = -f(\omega t)  \ \ t \in (0,\pi)\\
    f(\omega t + \pi/2)   = +f(\omega)    \ \ t \in (0,\pi/2)
\end{gather}

This two conditions simplify the expressions (\ref{an}) and (\ref{bn}), in this way:
\begin{align}
    a_n = & \  0 \ \ | \  \ \forall n \in \mathbb{Z}\\
    b_n = & \begin{cases}
        \frac{2}{\pi} \int_0^{\pi/2} f(\omega t ) \sin(n\omega t)d(\omega t) & \text{ if } n \text{ odd} \\
        0 & \text{ if } n \text{ even}
    \end{cases}
\end{align}

So, in summary $f(\omega t )$ can be written as follows:

\begin{gather}
    f(\omega t ) = \sum_{n \ odd}^\infty  b_n \sin(n \omega t) \\
    b_n = \frac{2}{\pi}\int_0^{\pi/2} f(\omega t ) \sin(n\omega t)d(\omega t) \ \ | \ \ n \ odd \label{bn_odd}
\end{gather}


Now in this context, we can define a SHE problem as follows:

\begin{problem}[SHE two levels]\label{SHEp}
    Given  $\bm{b}_T = [b^1_T \ , \ b^3_T \  , \ b^5_T \ , \ \dots \ , \ b^{N/2}_T] \in \mathbb{R}^{N/2}$, we search a wave form $f(\omega t ) \ | \ \omega t \in (0,\pi/2)$ such that $f$ only can take values  $\{-1,1\}$ and its Fourier coefficients $b_n$ satisfies $b_n=b_T^n \ | \ \forall n \in \{1,3,\dots,N/2 \}$. 
\end{problem}

In the typical formulation of this problem, the function $f(\omega t)$ can be represented by locations  where the function $f(\omega t)$ changes its value, this locations are named switching angles.
%
Given a some vector $\bm{b}^T$, the number of switching angles $M$ is \emph{a priori} unknown, so it's necessary fixed it. If we name switching angles as $\bm{\phi} = [\phi_1,\phi_2,\dots,\phi_M] \in \mathbb{R}^M $, we can simplify the expression (\ref{bn_odd}) as follows:

\begin{gather}
    b_n(\bm{\phi})  =  \frac{2}{n\pi  } \bigg[ -1 + 2\sum_{i=1}^M  (-1)^{i+1}\cos(n\phi_i) \bigg] \ | \ \forall n \ odd
\end{gather}

With this expression, we can formulate the problem (\ref{SHEp}) as the next mimization problem:

\begin{gather}
    \min_{\bm{\phi} \in \mathbb{R}^m} \sum_{n \ odd}^{N/2} (b_n(\bm{\phi}) - b^n_T)^2 \\
    \text{subject to:} \begin{cases}
        0 < \phi_1  \\
        \phi_n < \phi_n+2 &  \forall n \in \{3,5,\dots,N/2-2 \}\\
        \phi_{N/2} < \pi/2
    \end{cases}
\end{gather}

This formulation don't give a clearly procedure to choose a number of angles.
\newpage

We propose consider a search of a function $f(\omega t)$ directly. In this way, instead of looking for the switching angles $\bm{\phi} \in \mathbb{R}^M$, we look for a function $f(\omega t) \in \{ g(\omega t)  \in L^\infty([0,\pi/2])\ /\ |g(\omega t)| < 1\} $. 

Gracias al teorema fundamental del c치lculo, podemos afirmar que una funci칩n $\beta(\tau)$ definida como:
\begin{gather}
    \beta_n(\tau) = \frac{2}{\pi}\int_0^\tau f(\omega t) \sin(n\omega t)d(\omega t) 
    \Rightarrow
    \begin{cases} \label{ode}
        \frac{\partial \beta}{d\tau} & = \frac{2}{\pi}f(\tau)\sin(n\tau) \\  
        \beta(0) & = 0       
    \end{cases}
\end{gather}


Cuando resolvemos la ecuaci칩n diferencial ordinaria (\ref{ode}) hasta tiempo $T = \pi/2$ obtenemos el valor del coeficiente de Fourier $b_n$.

Este se puede ver como una ecuaci칩n diferencial ordinaria controlada donde los estados del sistema son $\beta_n$ y el control es $f(\tau) \ | \ \tau \in [0,\pi/2]$.
%
Entonces se puede plantear el problema de control cuyo objetivo es llevar el sistema $\beta_n(\tau)$ desde el estado nulo hasta $b_T^n$ para cada $n \in \{1,3,5,\dots,N/2 \}$ en un tiempo final $\tau_f = \pi/2$