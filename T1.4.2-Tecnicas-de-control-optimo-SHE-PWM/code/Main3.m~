clear all;close allimport casadi.*m = 3;as = SX.sym('a',m,1);bs = SX.sym('b',m,1);fs = SX.sym('f',1,1);ts = SX.sym('t');%aT = [1 0 0]';bT = [0 1 0]';%%%Xs = [as;bs];das = fs*sin([1:2:(2*m-1)]'.*ts);dbs = fs*cos([1:2:(2*m-1)]'.*ts);dynfcn = Function('f',{ts,Xs,fs},{ [das;dbs] });%tspan = linspace(0,pi,10);idyn = ode(dynfcn,Xs,fs,tspan);idyn.InitialCondition = zeros(2*m,1);SetIntegrator(idyn,'RK4')Control0 = ZerosControl(idyn);FreeState = solve(idyn,Control0);%epsilon = 1e-4;PathCost  = Function('L'  ,{ts,Xs,fs},{ epsilon*(fs^2)           });FinalCost = Function('Psi',{Xs}      ,{ (aT - as)'*(aT - as) + (bT - bs)'*(bT - bs)  });iocp = ocp(idyn,PathCost,FinalCost);ControlGuess = ZerosControl(idyn);[OptControl ,OptState] = Ipopt(iocp,ControlGuess);%%figuresubplot(1,2,1);plot(tspan,OptState');title('Optimal State')ylim([-1 2])%subplot(1,2,2);plot(tspan,OptControl)title('Free')ylim([-1 2])